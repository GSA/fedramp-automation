<?xml version="1.0" encoding="UTF-8"?>

<x:description
    run-as="external"
    schematron="../../rules/sap.sch"
    xmlns:x="http://www.jenitennison.com/xslt/xspec">

    <x:scenario
        label="import-ssp">

        <x:context>
            <assessment-plan
                xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                <import-ssp
                    href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                <back-matter>
                    <resource
                        uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                        <title>System Security Plan</title>
                        <prop
                            name="type"
                            value="system-security-plan" />
                        <rlink
                            href="../../../../dist/content/rev4/templates/ssp/xml/FedRAMP-SSP-OSCAL-Template.xml"
                            media-type="text/xml" />
                    </resource>
                </back-matter>
            </assessment-plan>
        </x:context>


        <x:scenario
            label="when the import-ssp element">

            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-import-ssp"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <!-- missing import-ssp -->
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-import-ssp"
                    label="that is an error" />
            </x:scenario>

            <x:scenario
                label="has an href attribute">
                <x:expect-not-assert
                    id="has-import-ssp-href"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="lacks an href attribute">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp /><!-- missing href -->
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-import-ssp-href"
                    label="that is an error" />
            </x:scenario>

        </x:scenario>

        <x:scenario
            label="when the import-ssp has a relative href">
            <x:scenario
                label="which refers to a resource">
                <x:expect-not-assert
                    id="has-import-ssp-internal-href"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="which does not refer to a resource">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <!-- missing resource -->
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-import-ssp-internal-href"
                    label="that is an error" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when the import-ssp has an external href"
            pending="XSpec problem resolution">
            <x:scenario
                label="which is available">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="file:/dev/null" />
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-import-ssp-external-href"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="which is not available"
                pending="XSpec problem resolution">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="file:x" />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-import-ssp-external-href"
                    label="that is an error" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when the import-ssp has a relative href">
            <x:scenario
                label="and the SSP is declared as a back-matter resource">
                <x:expect-not-assert
                    id="has-system-security-plan-resource"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="and the SSP is not declared as a back-matter resource">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <!-- missing resource -->
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-system-security-plan-resource"
                    label="that is an error" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when there is a system-security-plan resource">

            <x:scenario
                label="and it has one and only one rlink">
                <x:expect-not-assert
                    id="has-ssp-rlink"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="and it lacks an rlink">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <resource
                                uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                <title>System Security Plan</title>
                                <prop
                                    name="type"
                                    value="system-security-plan" />
                                <!-- missing rlink -->
                            </resource>
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-ssp-rlink"
                    label="that is an error" />
            </x:scenario>

            <x:scenario
                label="and it has more than one one rlink">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <resource
                                uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                <title>System Security Plan</title>
                                <prop
                                    name="type"
                                    value="system-security-plan" />
                                <rlink
                                    href="../../../../dist/content/rev4/templates/ssp/xml/FedRAMP-SSP-OSCAL-Template.xml"
                                    media-type="text/xml" />
                                <rlink
                                    href="../../../../dist/content/rev4/templates/ssp/json/FedRAMP-SSP-OSCAL-Template.json"
                                    media-type="application/json" />
                            </resource>
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-ssp-rlink"
                    label="that is an error" />
            </x:scenario>

            <x:scenario
                label="and the rlink has an allowed media-type">
                <x:expect-not-assert
                    id="has-acceptable-system-security-plan-rlink-media-type"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="and the rlink lacks an allowed media-type">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <resource
                                uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                <title>System Security Plan</title>
                                <prop
                                    name="type"
                                    value="system-security-plan" />
                                <rlink
                                    href="../../../../dist/content/rev4/templates/ssp/xml/FedRAMP-SSP-OSCAL-Template.xml"
                                    media-type="text/markdown" />
                            </resource>
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-acceptable-system-security-plan-rlink-media-type"
                    label="that is an error" />
            </x:scenario>

            <x:scenario
                label="and it lacks a base64">
                <x:expect-not-assert
                    id="has-no-base64"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="and it has a base64">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <import-ssp
                            href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                        <back-matter>
                            <resource
                                uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                <title>System Security Plan</title>
                                <prop
                                    name="type"
                                    value="system-security-plan" />
                                <base64 />
                            </resource>
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-no-base64"
                    label="that is an error" />
            </x:scenario>

        </x:scenario>
        <x:scenario
            label="when there is a no-oscal-ssp resource">
            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <import-ssp
                        href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                    <back-matter>
                        <resource
                            uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                            <title>System Security Plan</title>
                            <prop
                                name="type"
                                value="no-oscal-ssp" />
                        </resource>
                    </back-matter>
                </assessment-plan>
            </x:context>
            <x:expect-assert
                id="has-non-OSCAL-system-security-plan-resource"
                label="that should produce a warning" />
        </x:scenario>
        <x:scenario
            label="when there is not a no-oscal-ssp resource">
            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <import-ssp
                        href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                    <back-matter>
                        <resource
                            uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                            <title>System Security Plan</title>
                            <!-- no no-oscal-ssp prop -->
                        </resource>
                    </back-matter>
                </assessment-plan>
            </x:context>
            <x:expect-not-assert
                id="has-non-OSCAL-system-security-plan-resource"
                label="that should produce no warning" />
        </x:scenario>
    </x:scenario>


    <x:scenario
        label="In an OSCAL SAP">

        <x:context>
            <assessment-plan
                xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                <import-ssp
                    href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                <terms-and-conditions>
                    <part
                        name="methodology">
                        <prop
                            name="sampling"
                            ns="https://fedramp.gov/ns/oscal"
                            value="no" />
                    </part>
                    <part
                        name="disclosures">
                        <part
                            name="disclosure">
                            <p>A disclosure statement.</p>
                        </part>
                        <part
                            name="disclosure">
                            <p>Another disclosure statement.</p>
                        </part>
                    </part>
                </terms-and-conditions>
                <back-matter>
                    <resource
                        uuid="64fde0b3-3b15-44e8-a0bd-ce1301f95fbc">
                        <title>Penetration Testing Plan and Methodology</title>
                        <prop
                            name="type"
                            value="penetration-test-plan" />
                        <rlink
                            href="penetration-test-plan"
                            media-type="text/markdown" />
                    </resource>
                    <resource
                        uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                        <title>System Security Plan</title>
                        <prop
                            name="type"
                            value="system-security-plan" />
                        <rlink
                            href="../../../../dist/content/rev4/templates/ssp/xml/FedRAMP-SSP-OSCAL-Template.xml"
                            media-type="text/xml" />
                        <rlink
                            href="../../../../dist/content/rev4/templates/ssp/json/FedRAMP-SSP-OSCAL-Template.json"
                            media-type="application/json" />
                    </resource>
                </back-matter>
            </assessment-plan>
        </x:context>

        <x:scenario
            label="when the terms-and-conditions element">
            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-terms-and-conditions"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <!--  -->
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-terms-and-conditions"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when the methodology part">
            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-methodology"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <!--  -->
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-methodology"
                    label="that is incorrect" />
            </x:scenario>

            <x:scenario
                label="has a sampling prop with the value of no">
                <x:scenario
                    label="and the final paragraph has the correct statement.">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="methodology">
                                    <prop
                                        name="sampling"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="no" />
                                    <p>[3PAO Name] will not use sampling when performing this assessment.</p>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-sampling-method-statement"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and the final paragraph has an incorrect statement.">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="methodology">
                                    <prop
                                        name="sampling"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="no" />
                                    <p>[3PAO Name] will not use sampling.</p>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-sampling-method-statement"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>

            <x:scenario
                label="has a sampling prop with the value of yes">
                <x:scenario
                    label="and the final paragraph has the correct statement.">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="methodology">
                                    <prop
                                        name="sampling"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="yes" />
                                    <p>[3PAO Name] will use sampling when performing this assessment.</p>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-sampling-method-statement"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and the final paragraph has an incorrect statement.">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="methodology">
                                    <prop
                                        name="sampling"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="yes" />
                                    <p>[3PAO Name] will use sampling.</p>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-sampling-method-statement"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when the disclosures part">
            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-disclosures"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <!-- missing disclosures -->
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-disclosures"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when the sampling prop">
            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-sampling-method"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="methodology">
                                <!-- missing prop -->
                            </part>
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-sampling-method"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when the sampling prop value">
            <x:scenario
                label="is yes or no">
                <x:expect-not-assert
                    id="has-allowed-sampling-method"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is neither yes nor no">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="methodology">
                                <prop
                                    name="sampling"
                                    ns="https://fedramp.gov/ns/oscal"
                                    value="maybe" /><!-- incorrect value -->
                            </part>
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-allowed-sampling-method"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when diclosure statements are present">
            <x:expect-not-assert
                id="has-roe-disclosure-detail"
                label="that is correct" />
        </x:scenario>
        <x:scenario
            label="when diclosure statements are absent">
            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <!-- … -->
                    <terms-and-conditions>
                        <part
                            name="disclosures">
                            <!-- missing disclosure statements -->
                        </part>
                    </terms-and-conditions>
                    <!-- … -->
                </assessment-plan>
            </x:context>
            <x:expect-assert
                id="has-roe-disclosure-detail"
                label="that is an error" />
        </x:scenario>

        <x:scenario
            label="when the penetration-test-plan resource">
            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="has-penetration-test-plan"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="is absent">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <!-- missing penetration-test-plan resource -->
                        </back-matter>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-penetration-test-plan"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="signed-sap">

            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <!-- … -->
                    <back-matter>
                        <resource
                            uuid="1e083471-9a3c-4469-8926-5b93215c6a11">
                            <description>
                                <p>Signed SAP</p>
                            </description>
                            <prop
                                name="type"
                                value="signed-sap" />
                            <rlink
                                href="signed-sap.pdf"
                                media-type="application/pdf" />
                        </resource>
                    </back-matter>
                </assessment-plan>
            </x:context>

            <x:scenario
                label="when the signed-sap resource">

                <x:scenario
                    label="is present">
                    <x:expect-not-assert
                        id="has-signed-sap-resource"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="is absent">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <!-- … -->
                            <back-matter>
                                <!-- missing signed-sap resource -->
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-signed-sap-resource"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="has a description">
                    <x:expect-not-assert
                        id="signed-sap-resource-has-description"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks a description">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <!-- … -->
                            <back-matter>
                                <resource
                                    uuid="1e083471-9a3c-4469-8926-5b93215c6a11">
                                    <!-- missing description -->
                                    <prop
                                        name="type"
                                        value="signed-sap" />
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="signed-sap-resource-has-description"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="has an rlink">
                    <x:expect-not-assert
                        id="signed-sap-resource-has-rlink"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks an rlink">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <!-- … -->
                            <back-matter>
                                <resource
                                    uuid="1e083471-9a3c-4469-8926-5b93215c6a11">
                                    <prop
                                        name="type"
                                        value="signed-sap" />
                                    <!-- missing rlink -->
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="signed-sap-resource-has-rlink"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="rlink has a PDF media-type">
                    <x:expect-not-assert
                        id="signed-sap-rlink-has-media-type-pdf"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="rlink does not have a PDF media-type">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <!-- … -->
                            <back-matter>
                                <resource
                                    uuid="1e083471-9a3c-4469-8926-5b93215c6a11">
                                    <prop
                                        name="type"
                                        value="signed-sap" />
                                    <rlink
                                        href="signed-sap.pdf"
                                        media-type="test/xml" />
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="signed-sap-rlink-has-media-type-pdf"
                        label="that is an error" />
                </x:scenario>


            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when in a control-selection element">
            <x:scenario
                label="and an include-all or include-control, but not both, is present">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-all />
                            <exclude-control
                                control-id="ac-1" />
                        </control-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="include-all-or-include-control"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-all />
                            <include-control
                                control-id="ac-1" />
                        </control-selection>
                    </x:context>
                    <x:expect-assert
                        id="include-all-or-include-control"
                        label="this is an error" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="and the include-control/@control-id and exclude-control/@control-id values are all different">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-control
                                control-id="ac-1" />
                            <include-control
                                control-id="ac-2" />
                        </control-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="duplicate-exclude-control-and-include-control-values"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-control
                                control-id="ac-1" />
                            <include-control
                                control-id="ac-1" />
                        </control-selection>
                    </x:context>
                    <x:expect-assert
                        id="duplicate-exclude-control-and-include-control-values"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="and the include-control/@control-id values are all different">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-control
                                control-id="ac-1" />
                            <include-control
                                control-id="ac-2" />
                        </control-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="duplicate-include-control-values"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-control
                                control-id="ac-1" />
                            <include-control
                                control-id="ac-1" />
                        </control-selection>
                    </x:context>
                    <x:expect-assert
                        id="duplicate-include-control-values"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="and the exclude-control/@control-id values are all different">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-control
                                control-id="ac-1" />
                            <exclude-control
                                control-id="ac-2" />
                        </control-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="duplicate-exclude-control-values"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-control
                                control-id="ac-1" />
                            <exclude-control
                                control-id="ac-1" />
                        </control-selection>
                    </x:context>
                    <x:expect-assert
                        id="duplicate-exclude-control-values"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when in a control-objective-selection element">
            <x:scenario
                label="and an include-all or include-control, but not both, is present">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-all />
                            <exclude-control
                                control-id="ac-1" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="include-all-or-include-objective"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-all />
                            <include-objective
                                objective-id="ac-1.a.1_obj.1" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-assert
                        id="include-all-or-include-objective"
                        label="this is an error" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="and the include-objective/@objective-id and exclude-objective/@objective-id values are all different">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-objective
                                objective-id="ac-1.a.1_obj.1" />
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.2" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="duplicate-exclude-objective-and-include-objective-values"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <include-objective
                                objective-id="ac-1.a.1_obj.1" />
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.1" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-assert
                        id="duplicate-exclude-objective-and-include-objective-values"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="and the include-objective/@objective-id values are all different">
                <x:context>
                    <control-objective-selection
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <include-objective
                            objective-id="ac-1.a.1_obj.1" />
                        <include-objective
                            objective-id="ac-1.a.1_obj.2" />
                    </control-objective-selection>
                </x:context>
                <x:expect-not-assert
                    id="duplicate-include-objective-values"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="and the include-objective/@objective-id values are not different">
                <x:context>
                    <control-objective-selection
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <include-objective
                            objective-id="ac-1.a.1_obj.1" />
                        <include-objective
                            objective-id="ac-1.a.1_obj.2" />
                        <include-objective
                            objective-id="ac-1.a.1_obj.1" />
                    </control-objective-selection>
                </x:context>
                <x:expect-assert
                    id="duplicate-include-objective-values"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="and the exclude-objective/@objective-id values are all different">
                <x:scenario
                    label="when that is true">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.1" />
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.2" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-not-assert
                        id="duplicate-exclude-objective-values"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when that is false">
                    <x:context>
                        <control-objective-selection
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.1" />
                            <exclude-objective
                                objective-id="ac-1.a.1_obj.1" />
                        </control-objective-selection>
                    </x:context>
                    <x:expect-assert
                        id="duplicate-exclude-objective-values"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>

        <x:scenario
            label="when in an assessment-subject[@type='location'] element">
            <x:scenario
                label="and there is an include-all child element">
                <x:context>
                    <assessment-subject
                        type="location"
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <include-all />
                    </assessment-subject>
                </x:context>
                <x:expect-assert
                    id="location-not-include-all-element"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="and there is not an include-all child element">
                <x:context>
                    <assessment-subject
                        type="location"
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <include-subject />
                    </assessment-subject>
                </x:context>
                <x:expect-not-assert
                    id="location-not-include-all-element"
                    label="that is correct" />
            </x:scenario>
        </x:scenario>
    </x:scenario>
    <x:scenario
        label="In a FedRAMP SAP">
        <x:scenario
            label="in the metadata">
            <x:scenario
                label="when there is a role element with an @id of 'csp-end-of-testing-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="csp-end-of-testing-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-role-end-of-testing"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a role element with an @id of 'csp-end-of-testing-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="junk" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-role-end-of-testing"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a reponsible-party element with a @role-id of 'csp-end-of-testing-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-end-of-testing-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-end-of-testing"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a reponsible-party element with a @role-id of 'csp-end-of-testing-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-end-of-testing"
                    label="that is an error" />
            </x:scenario>
            <x:scenario
                label="when there is a reponsible-party element with a @role-id of 'csp-end-of-testing-poc'">
                <x:scenario
                    label="and a child party-uuid element">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="csp-end-of-testing-poc">
                                    <party-uuid />
                                </responsible-party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-metadata-responsible-party-uuid"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and not a child party-uuid element">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="csp-end-of-testing-poc" />
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-metadata-responsible-party-uuid"
                        label="that is an error" />
                </x:scenario>
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when a terms-and-conditions">
            <x:scenario
                label="has a part named 'assumptions'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="assumptions" />
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-part-named-assumptions"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="does not have a part named 'assumptions'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-part-named-assumptions"
                    label="that is incorrect" />
            </x:scenario>

            <x:scenario
                label="within a part named 'assumptions'">
                <x:scenario
                    label="the parts named 'assumption' are correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="assumptions">
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="assumption-ordered"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="the parts named 'assumption' are not correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="assumptions">
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="assumption">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="assumption-ordered"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="within a part named 'disclosures'">
                <x:scenario
                    label="when the parts named 'disclosure' are correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="disclosures">
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="disclosure-ordered"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="when the parts named 'disclosure' are not correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="disclosures">
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="disclosure">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="disclosure-ordered"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="has a part named 'included-activities'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="included-activities" />
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-part-named-included-activities"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="does not have a part named 'included-activities'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-part-named-included-activities"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="has a part named 'included-activities'">
                <x:scenario
                    label="and at least one part named 'included-activity'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="included-activities">
                                    <part
                                        name="included-activity" />
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-roe-included-activity"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and does not have at least one part named 'included-activity'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="included-activities" />
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-roe-included-activity"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="does not have a part named 'included-activities'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-part-named-included-activities"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when a task has a property of the value 'web-application'">
            <x:scenario
                label="has a part named 'excluded-activities'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="excluded-activities" />
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-part-named-excluded-activities"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="does not have a part named 'excluded-activities'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-part-named-excluded-activities"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="has a part named 'excluded-activities'">
                <x:scenario
                    label="and at least one part named 'excluded-activity'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="excluded-activities">
                                    <part
                                        name="excluded-activity" />
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-roe-excluded-activity"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and does not have at least one part named 'excluded-activity'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="excluded-activities" />
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-roe-excluded-activity"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when a task has a property of the value 'web-application'">
            <x:scenario
                label="has a part named 'liability-limitations'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions>
                            <part
                                name="liability-limitations" />
                        </terms-and-conditions>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-part-named-liability-limitations"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="does not have a part named 'liability-limitations'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <terms-and-conditions />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-part-named-liability-limitations"
                    label="that is incorrect" />
            </x:scenario>

            <x:scenario
                label="has a part named 'liability-limitations'">
                <x:scenario
                    label="and there is at least one child part named 'liability-limitation'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="liability-limitations">
                                    <part
                                        name="liability-limitation" /> <part
                                        name="liability-limitation" />
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-liability-limitation"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and there is not at least one child part named 'liability-limitation'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="liability-limitations" />
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-liability-limitation"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and the child parts named 'liability-limitation' are correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="liability-limitations">
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="liability-limitations-ordered"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and the child parts named 'liability-limitation' are not correctly ordered">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <terms-and-conditions>
                                <part
                                    name="liability-limitations">
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="002" />
                                    </part>
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="001" />
                                    </part>
                                    <part
                                        name="liability-limitation">
                                        <prop
                                            name="sort-id"
                                            value="003" />
                                    </part>
                                </part>
                            </terms-and-conditions>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="liability-limitations-ordered"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="when a task has a property of the value 'web-application'">
            <x:scenario
                label="with a property with the name 'login-url'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="web-application" />
                            <prop
                                name="login-url"
                                ns="https://fedramp.gov/ns/oscal"
                                value="https://service.offering.com/login" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-login-url-task"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="without a property with the name 'login-url'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="web-application" />
                            <prop
                                name="test"
                                value="test" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-login-url-task"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="with a property with the name 'login-id'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="web-application" />
                            <prop
                                name="login-id"
                                ns="https://fedramp.gov/ns/oscal"
                                value="https://service.offering.com/login" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-login-id-task"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="without a property with the name 'login-id'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="web-application" />
                            <prop
                                name="test"
                                value="test" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-login-id-task"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="in the metadata">
            <x:scenario
                label="when there is an assessment-subject with a @type='location'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0" />
                </x:context>
                <x:expect-assert
                    id="has-location-assessment-subject"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="and there is not an include-all child element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <assessment-subject
                            type="location" />
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-location-assessment-subject"
                    label="that is correct" />
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="in the assessment-assests">
            <x:scenario
                label="when there is a component element with type 'software'">
                <x:scenario
                    label="and a property with the name 'vendor' exists">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460">
                                    <prop
                                        name="vendor"
                                        value="Vendor Name" />
                                </component>
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-software-component-vendor"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and a property with the name 'vendor' does not exist">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-software-component-vendor"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and a property with the name 'name' exists">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460">
                                    <prop
                                        name="name"
                                        value="Tool Name" />
                                </component>
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-software-component-tool"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and a property with the name 'name' does not exist">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-software-component-tool"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and a property with the name 'version' exists">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460">
                                    <prop
                                        name="version"
                                        value="1.2.3" />
                                </component>
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-software-component-version"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and a property with the name 'version' does not exist">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-software-component-version"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and a status with the state of 'operational' exists">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460">
                                    <status
                                        state="operational" />
                                </component>
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-software-component-status"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and a status with the state of 'operational' does not exist">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <assessment-assets>
                                <component
                                    type="software"
                                    uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460">
                                    <status
                                        state="operating" />
                                </component>
                            </assessment-assets>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-software-component-status"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="when there is an assessment-subject with a @type='location'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0" />
                </x:context>
                <x:expect-assert
                    id="has-location-assessment-subject"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="and there is not an include-all child element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <assessment-subject
                            type="location" />
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-location-assessment-subject"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is a role element with an @id of 'assessor'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="assessor" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-role-assessor"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="there is not a role element with an @id of 'assessor'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-role-assessor"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a role element with an @id of 'assessment-team'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="assessment-team" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-assessment-team-role"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="there is not a role element with an @id of 'assessment-team'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-assessment-team-role"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a responsible-party element with an @role-id of 'assessment-team'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="assessment-team" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-assessment"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a responsible-party element with an @role-id of 'assessment-team'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-assessment"
                    label="that is incorrect" />
            </x:scenario>

            <x:scenario
                label="when there is a responsible-party element with an @role-id of 'assessment-lead'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="assessment-lead" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-lead"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a responsible-party element with an @role-id of 'assessment-lead'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-lead"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a single responsible-party element with an @role-id of 'assessment-lead'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="assessment-lead" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-lead-multiple"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there are multiple responsible-party elements with an @role-id of 'assessment-lead'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="assessment-lead" />
                            <responsible-party
                                role-id="assessment-lead" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-lead-multiple"
                    label="that is incorrect" />
            </x:scenario>

            <x:scenario
                label="when a responsible-party with an @role-id of 'assessment lead' exists">
                <x:scenario
                    label="and has a child party-uuid value that matches a party-uuid value in the responsible-party with an @role-id of 'assessment-team'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="assessment-team">
                                    <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                    <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                                    <party-uuid>abc15ce6-1f43-4951-bcd5-ab62cdff7ed9</party-uuid>
                                    <party-uuid>9135b789-a40c-4a20-9be6-fab23c0ab0f3</party-uuid>
                                </responsible-party>
                                <responsible-party
                                    role-id="assessment-lead">
                                    <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                </responsible-party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-metadata-responsible-party-lead-matches"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and has a child party-uuid value that does not matche a party-uuid value in the responsible-party with an @role-id of 'assessment-team'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="assessment-team">
                                    <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                    <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                                    <party-uuid>abc15ce6-1f43-4951-bcd5-ab62cdff7ed9</party-uuid>
                                    <party-uuid>9135b789-a40c-4a20-9be6-fab23c0ab0f3</party-uuid>
                                </responsible-party>
                                <responsible-party
                                    role-id="assessment-lead">
                                    <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fc</party-uuid>
                                </responsible-party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-metadata-responsible-party-lead-matches"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>

            <x:scenario
                label="when assessment team has at least one party-uuid element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe" />
                            <party
                                type="person"
                                uuid="abc15ce6-1f43-4951-bcd5-ab62cdff7ed9" />
                            <party
                                type="person"
                                uuid="bcf47707-49e4-4acc-bf43-e63156046390" />
                            <party
                                type="person"
                                uuid="9135b789-a40c-4a20-9be6-fab23c0ab0f3" />
                            <responsible-party
                                role-id="assessment-team">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                                <party-uuid>abc15ce6-1f43-4951-bcd5-ab62cdff7ed9</party-uuid>
                                <party-uuid>9135b789-a40c-4a20-9be6-fab23c0ab0f3</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-has-party-uuid"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when assessment team does not have at least one party-uuid element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe" />
                            <party
                                type="person"
                                uuid="bcf47707-49e4-4acc-bf43-e63156046390" />
                            <party
                                type="person"
                                uuid="abc15ce6-1f43-4951-bcd5-ab62cdff7ed9" />
                            <responsible-party
                                role-id="assessment-team" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-has-party-uuid"
                    label="that is incorrect" />
            </x:scenario>


            <x:scenario
                label="when assessment team has matching party uuids">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe" />
                            <party
                                type="person"
                                uuid="abc15ce6-1f43-4951-bcd5-ab62cdff7ed9" />
                            <party
                                type="person"
                                uuid="bcf47707-49e4-4acc-bf43-e63156046390" />
                            <party
                                type="person"
                                uuid="9135b789-a40c-4a20-9be6-fab23c0ab0f3" />
                            <responsible-party
                                role-id="assessment-team">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                                <party-uuid>abc15ce6-1f43-4951-bcd5-ab62cdff7ed9</party-uuid>
                                <party-uuid>9135b789-a40c-4a20-9be6-fab23c0ab0f3</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-matches"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when assessment team does not have matching party uuids">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe" />
                            <party
                                type="person"
                                uuid="bcf47707-49e4-4acc-bf43-e63156046390" />
                            <party
                                type="person"
                                uuid="abc15ce6-1f43-4951-bcd5-ab62cdff7ed9" />
                            <responsible-party
                                role-id="assessment-team">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                                <party-uuid>abc15ce6-1f43-4951-bcd5-ab62cdff7ed9</party-uuid>
                                <party-uuid>9135b789-a40c-4a20-9be6-fab23c0ab0f3</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-matches"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when the assessment-lead has a party-uuid that matches a party/@uuid that has a telephone number">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe">
                                <name>[SAMPLE]Person Name 2</name>
                                <prop
                                    name="mail-stop"
                                    value="Office 2-B" />
                                <email-address>name@example.com</email-address>
                                <telephone-number>202-000-0002</telephone-number>
                                <location-uuid>49f73135-efab-4275-9a79-003656ad890a</location-uuid>
                                <member-of-organization>49f73135-efab-4275-9a79-003656ad890a</member-of-organization>
                            </party>
                            <responsible-party
                                role-id="assessment-team">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-phone"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when the assessment-lead does not have a party-uuid that matches a party/@uuid that has a telephone number">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe">
                                <name>[SAMPLE]Person Name 2</name>
                                <prop
                                    name="mail-stop"
                                    value="Office 2-B" />
                                <email-address>name@example.com</email-address>
                                <location-uuid>49f73135-efab-4275-9a79-003656ad890a</location-uuid>
                                <member-of-organization>49f73135-efab-4275-9a79-003656ad890a</member-of-organization>
                            </party>
                            <responsible-party
                                role-id="assessment-lead">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-phone"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when the assessment-lead has a party-uuid that matches a party/@uuid that has an email address">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe">
                                <name>[SAMPLE]Person Name 2</name>
                                <prop
                                    name="mail-stop"
                                    value="Office 2-B" />
                                <email-address>name@example.com</email-address>
                                <location-uuid>49f73135-efab-4275-9a79-003656ad890a</location-uuid>
                                <member-of-organization>49f73135-efab-4275-9a79-003656ad890a</member-of-organization>
                            </party>
                            <responsible-party
                                role-id="assessment-team">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>bcf47707-49e4-4acc-bf43-e63156046390</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-email"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when the assessment-lead does not have a party-uuid that matches a party/@uuid that has an email address">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party
                                type="person"
                                uuid="e934d8b5-13e5-4f77-b55e-871e6f2df2fe">
                                <name>[SAMPLE]Person Name 2</name>
                                <prop
                                    name="mail-stop"
                                    value="Office 2-B" />
                                <telephone-number>202-000-0002</telephone-number>
                                <location-uuid>49f73135-efab-4275-9a79-003656ad890a</location-uuid>
                                <member-of-organization>49f73135-efab-4275-9a79-003656ad890a</member-of-organization>
                            </party>
                            <responsible-party
                                role-id="assessment-lead">
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-email"
                    label="that is incorrect" />
            </x:scenario>
            <!--  -->
            <x:scenario
                label="when there is a role element with an @id of 'csp-assessment-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="csp-assessment-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-csp-poc-role"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="there is not a role element with an @id of 'csp-assessment-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-csp-poc-role"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a responsible-party element with an @role-id of 'csp-assessment-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-assessment-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-csp-poc-responsible-party"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a responsible-party element with an @role-id of 'csp-assessment-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-csp-poc-responsible-party"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there are at least 3 party-uuid elements as children of responsible-party[@role-id='csp-assessment-poc']">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-assessment-poc">
                                <party-uuid>f4568fda-c6d2-4640-adec-0012015af7d0</party-uuid>
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>4c9df173-6e48-4c4b-ad6a-957f54a2823e</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-csp-poc-matches"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there are not at least 3 party-uuid elements as children of responsible-party[@role-id='csp-assessment-poc']">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-assessment-poc">
                                <party-uuid>f4568fda-c6d2-4640-adec-0012015af7d0</party-uuid>
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-csp-poc-matches"
                    label="that is incorrect" />
            </x:scenario>
            <!--  -->
            <x:scenario
                label="when at least one of the responsible party POCs is an Operations Center">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-operations-center">
                                <party-uuid>4c9df173-6e48-4c4b-ad6a-957f54a2823e</party-uuid>
                            </responsible-party>
                            <responsible-party
                                role-id="csp-assessment-poc">
                                <party-uuid>f4568fda-c6d2-4640-adec-0012015af7d0</party-uuid>
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                                <party-uuid>4c9df173-6e48-4c4b-ad6a-957f54a2823e</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-csp-poc-responsible-party-ops-center"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when at least one of the responsible party POCs is not an Operations Center">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-operations-center">
                                <party-uuid>4c9df173-6e48-4c4b-ad6a-957f54a2823e</party-uuid>
                            </responsible-party>
                            <responsible-party
                                role-id="csp-assessment-poc">
                                <party-uuid>f4568fda-c6d2-4640-adec-0012015af7d0</party-uuid>
                                <party-uuid>e934d8b5-13e5-4f77-b55e-871e6f2df2fe</party-uuid>
                            </responsible-party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-csp-poc-responsible-party-ops-center"
                    label="that is incorrect" />
            </x:scenario>
            <!--  -->
            <x:scenario
                label="when there is a location element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <location />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-location"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a location element">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-location"
                    label="that is an error" />
            </x:scenario>
            <x:scenario
                label="when there is a party element with the @name of 'iso-iec-17020-identifier'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party>
                                <prop
                                    name="iso-iec-17020-identifier"
                                    ns="https://fedramp.gov/ns/oscal"
                                    value="0000.00" />
                            </party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-party"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a party element with the @name of 'iso-iec-17020-identifier'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <party>
                                <prop
                                    name="not17020"
                                    ns="https://fedramp.gov/ns/oscal"
                                    value="0000.00" />
                            </party>
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-party"
                    label="that is an error" />
            </x:scenario>

            <x:scenario
                label="when there is a party element with the @name of 'iso-iec-17020-identifier'">
                <x:scenario
                    label="whose @value is correctly formatted">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <party>
                                    <prop
                                        name="iso-iec-17020-identifier"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="0000.00" />
                                </party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-metadata-correctly-formatted-party"
                        label="that is correct" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="when there is not a party element with the @name of 'iso-iec-17020-identifier'">
                <x:scenario
                    label="whose @value is incorrectly formatted">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <party>
                                    <prop
                                        name="iso-iec-17020-identifier"
                                        ns="https://fedramp.gov/ns/oscal"
                                        value="A00A.00" />
                                </party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-metadata-correctly-formatted-party"
                        label="that is an error" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="when there is a role with an @id of 'csp-results-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <role
                                id="csp-results-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-role-test-results"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a role with an @id of 'csp-results-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-role-test-results"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a responsible-party with an @role-id of 'csp-results-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata>
                            <responsible-party
                                role-id="csp-results-poc" />
                        </metadata>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-metadata-responsible-party-test-results"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when there is not a responsible-party with an @role-id of 'csp-results-poc'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <metadata />
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-metadata-responsible-party-test-results"
                    label="that is incorrect" />
            </x:scenario>
            <x:scenario
                label="when there is a responsible-party with an @role-id of 'csp-results-poc'">
                <x:scenario
                    label="and it has at least one child party-uuid element">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="csp-results-poc">
                                    <party-uuid />
                                </responsible-party>
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-metadata-responsible-party-results-uuid"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and it does not have a child party-uuid element'">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <metadata>
                                <responsible-party
                                    role-id="csp-results-poc" />
                            </metadata>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-metadata-responsible-party-results-uuid"
                        label="that is incorrect" />
                </x:scenario>
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="there exists an assessment-subject with a type of 'user'">
            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <assessment-subject
                        type="user" />
                </assessment-plan>
            </x:context>
            <x:expect-not-assert
                id="has-user-assessment-subject"
                label="that is correct" />
        </x:scenario>
        <x:scenario
            label="there does not exist an assessment-subject with a type of 'user'">
            <x:context>
                <assessment-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0" />
            </x:context>
            <x:expect-assert
                id="has-user-assessment-subject"
                label="that is incorrect" />
        </x:scenario>
        <x:scenario
            label="when a task has a property of the value 'role-based'">
            <x:scenario
                label="with a property with the name 'login-id'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="role-based" />
                            <prop
                                name="login-id"
                                ns="https://fedramp.gov/ns/oscal"
                                value="https://service.offering.com/login" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-login-id-user-task"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="without a property with the name 'login-id'">
                <x:context>
                    <assessment-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <task>
                            <prop
                                value="role-based" />
                            <prop
                                name="test"
                                value="test" />
                        </task>
                    </assessment-plan>
                </x:context>
                <x:expect-assert
                    id="has-login-id-user-task"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>
        <x:scenario
            label="in an assessment-platform">
            <x:scenario
                label="when a prop has a @name of 'ip4-address">
                <x:scenario
                    label="and has a correctly formatted value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv4-address"
                                value="10.10.10.10" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-not-assert
                        id="ipv4-has-content"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and has an incorrectly formatted value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv4-address"
                                value="10.10.10.1088888" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-assert
                        id="ipv4-has-content"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and has a placeholder value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv4-address"
                                value="0.0.0.0" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-assert
                        id="ipv4-has-non-placeholder"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and has a non-placeholder value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv4-address"
                                value="10.10.10.10" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-not-assert
                        id="ipv4-has-non-placeholder"
                        label="that is correct" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="when a prop has a @name of 'ipv6-address">
                <x:scenario
                    label="and has a correctly formatted value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv6-address"
                                value="2001:db8:3333:4444:5555:6666:7777:8888." />
                        </assessment-platform>
                    </x:context>
                    <x:expect-not-assert
                        id="ipv6-has-content"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and has an incorrectly formatted value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv6-address"
                                value="1234:5678:9012:3456" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-assert
                        id="ipv6-has-content"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and has a placeholder value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv6-address"
                                value="::" />
                        </assessment-platform>
                    </x:context>
                    <x:expect-assert
                        id="ipv6-has-non-placeholder"
                        label="that is incorrect" />
                </x:scenario>
                <x:scenario
                    label="and has a non-placeholder value">
                    <x:context>
                        <assessment-platform
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <prop
                                name="ipv6-address"
                                value="2001:db8:3333:4444:5555:6666:7777:8888." />
                        </assessment-platform>
                    </x:context>
                    <x:expect-not-assert
                        id="ipv6-has-non-placeholder"
                        label="that is correct" />
                </x:scenario>
            </x:scenario>
            <x:scenario
                label="when uses-component/@component-uuid value matches an assessment-plan/component/@uuid value">
                <x:context>
                    <assessment-assets
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <component
                            type="hardware"
                            uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                        <component
                            type="software"
                            uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                        <assessment-platform>
                            <uses-component
                                component-uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                            <uses-component
                                component-uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                            <uses-component
                                component-uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                        </assessment-platform>
                    </assessment-assets>
                </x:context>
                <x:expect-not-assert
                    id="has-uses-component-match"
                    label="that is correct" />
            </x:scenario>
            <x:scenario
                label="when uses-component/@component-uuid value does not match an assessment-plan/component/@uuid value">
                <x:context>
                    <assessment-assets
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <component
                            type="hardware"
                            uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                        <assessment-platform>
                            <uses-component
                                component-uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                            <uses-component
                                component-uuid="BA991C3F-1E00-4C38-BF81-86A9E503F3B9" />
                            <uses-component
                                component-uuid="040937c3-2e0e-407a-bb3c-d4e61ac1c460" />
                        </assessment-platform>
                    </assessment-assets>
                </x:context>
                <x:expect-assert
                    id="has-uses-component-match"
                    label="that is incorrect" />
            </x:scenario>
        </x:scenario>
    </x:scenario>
</x:description>
