<?xml version="1.0" encoding="UTF-8"?>
<metaschema-meta-constraints xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0">
    <!-- ================== -->
    <!-- FedRAMP Extensions -->
    <!-- ================== -->
    <context>
        <metapath target="/catalog//control"/>
        <metapath target="/assessment-plan/local-definitions/objectives-and-methods"/>
        <metapath target="/assessment-results/local-definitions/objectives-and-methods"/>

        <constraints>
            <expect id="prop-response-point-has-cardinality-one" target=".//part" test="count(prop[@ns='https://fedramp.gov/ns/oscal' and @name='response-point']) &lt;= 1">
                <message>Duplicate reponse point at '{ path(.) }'.</message>
            </expect>
            <remarks>
                <p>This appears in FedRAMP profiles and resolved profile catalogs.</p>
                <p>For control statements, it signals to the CSP which statements require a response in the SSP.</p>
                <p>For control objectives, it signals to the assessor which control objectives must appear in the assessment results, which aligns with the FedRAMP test case workbook.</p>
             </remarks>
        </constraints>
</context>
<context>
    <metapath target="/system-security-plan/metadata/location"/>
    <constraints>
        <expect id="data-center-country-code" target="." test="count(address/country) eq 1">
            <message>Each data center address must contain a country code.</message>
        </expect>
        <allowed-values id="data-center-allowed-country-code" target="address/country" allow-other="no" level="ERROR">
            <formal-name>Data Center Country Code</formal-name>
            <description>Specifies the allowed country codes for data center addresses.</description>
            <enum value="AF">Afghanistan</enum>
            <enum value="AX">Åland Islands</enum>
            <enum value="AL">Albania</enum>
            <enum value="DZ">Algeria</enum>
            <enum value="AS">American Samoa</enum>
            <enum value="AD">Andorra</enum>
            <enum value="AO">Angola</enum>
            <enum value="AI">Anguilla</enum>
            <enum value="AQ">Antarctica</enum>
            <enum value="AG">Antigua and Barbuda</enum>
            <enum value="AR">Argentina</enum>
            <enum value="AM">Armenia</enum>
            <enum value="AW">Aruba</enum>
            <enum value="AU">Australia</enum>
            <enum value="AT">Austria</enum>
            <enum value="AZ">Azerbaijan</enum>
            <enum value="BS">Bahamas</enum>
            <enum value="BH">Bahrain</enum>
            <enum value="BD">Bangladesh</enum>
            <enum value="BB">Barbados</enum>
            <enum value="BY">Belarus</enum>
            <enum value="BE">Belgium</enum>
            <enum value="BZ">Belize</enum>
            <enum value="BJ">Benin</enum>
            <enum value="BM">Bermuda</enum>
            <enum value="BT">Bhutan</enum>
            <enum value="BO">Bolivia, Plurinational State of</enum>
            <enum value="BQ">Bonaire, Sint Eustatius and Saba</enum>
            <enum value="BA">Bosnia and Herzegovina</enum>
            <enum value="BW">Botswana</enum>
            <enum value="BV">Bouvet Island</enum>
            <enum value="BR">Brazil</enum>
            <enum value="IO">British Indian Ocean Territory</enum>
            <enum value="BN">Brunei Darussalam</enum>
            <enum value="BG">Bulgaria</enum>
            <enum value="BF">Burkina Faso</enum>
            <enum value="BI">Burundi</enum>
            <enum value="CV">Cabo Verde</enum>
            <enum value="KH">Cambodia</enum>
            <enum value="CM">Cameroon</enum>
            <enum value="CA">Canada</enum>
            <enum value="KY">Cayman Islands</enum>
            <enum value="CF">Central African Republic</enum>
            <enum value="TD">Chad</enum>
            <enum value="CL">Chile</enum>
            <enum value="CN">China</enum>
            <enum value="CX">Christmas Island</enum>
            <enum value="CC">Cocos (Keeling) Islands</enum>
            <enum value="CO">Colombia</enum>
            <enum value="KM">Comoros</enum>
            <enum value="CG">Congo</enum>
            <enum value="CD">Congo, Democratic Republic of the</enum>
            <enum value="CK">Cook Islands</enum>
            <enum value="CR">Costa Rica</enum>
            <enum value="CI">Côte d'Ivoire</enum>
            <enum value="HR">Croatia</enum>
            <enum value="CU">Cuba</enum>
            <enum value="CW">Curaçao</enum>
            <enum value="CY">Cyprus</enum>
            <enum value="CZ">Czechia</enum>
            <enum value="DK">Denmark</enum>
            <enum value="DJ">Djibouti</enum>
            <enum value="DM">Dominica</enum>
            <enum value="DO">Dominican Republic</enum>
            <enum value="EC">Ecuador</enum>
            <enum value="EG">Egypt</enum>
            <enum value="SV">El Salvador</enum>
            <enum value="GQ">Equatorial Guinea</enum>
            <enum value="ER">Eritrea</enum>
            <enum value="EE">Estonia</enum>
            <enum value="SZ">Eswatini</enum>
            <enum value="ET">Ethiopia</enum>
            <enum value="FK">Falkland Islands (Malvinas)</enum>
            <enum value="FO">Faroe Islands</enum>
            <enum value="FJ">Fiji</enum>
            <enum value="FI">Finland</enum>
            <enum value="FR">France</enum>
            <enum value="GF">French Guiana</enum>
            <enum value="PF">French Polynesia</enum>
            <enum value="TF">French Southern Territories</enum>
            <enum value="GA">Gabon</enum>
            <enum value="GM">Gambia</enum>
            <enum value="GE">Georgia</enum>
            <enum value="DE">Germany</enum>
            <enum value="GH">Ghana</enum>
            <enum value="GI">Gibraltar</enum>
            <enum value="GR">Greece</enum>
            <enum value="GL">Greenland</enum>
            <enum value="GD">Grenada</enum>
            <enum value="GP">Guadeloupe</enum>
            <enum value="GU">Guam</enum>
            <enum value="GT">Guatemala</enum>
            <enum value="GG">Guernsey</enum>
            <enum value="GN">Guinea</enum>
            <enum value="GW">Guinea-Bissau</enum>
            <enum value="GY">Guyana</enum>
            <enum value="HT">Haiti</enum>
            <enum value="HM">Heard Island and McDonald Islands</enum>
            <enum value="VA">Holy See</enum>
            <enum value="HN">Honduras</enum>
            <enum value="HK">Hong Kong</enum>
            <enum value="HU">Hungary</enum>
            <enum value="IS">Iceland</enum>
            <enum value="IN">India</enum>
            <enum value="ID">Indonesia</enum>
            <enum value="IR">Iran, Islamic Republic of</enum>
            <enum value="IQ">Iraq</enum>
            <enum value="IE">Ireland</enum>
            <enum value="IM">Isle of Man</enum>
            <enum value="IL">Israel</enum>
            <enum value="IT">Italy</enum>
            <enum value="JM">Jamaica</enum>
            <enum value="JP">Japan</enum>
            <enum value="JE">Jersey</enum>
            <enum value="JO">Jordan</enum>
            <enum value="KZ">Kazakhstan</enum>
            <enum value="KE">Kenya</enum>
            <enum value="KI">Kiribati</enum>
            <enum value="KP">Korea, Democratic People's Republic of</enum>
            <enum value="KR">Korea, Republic of</enum>
            <enum value="KW">Kuwait</enum>
            <enum value="KG">Kyrgyzstan</enum>
            <enum value="LA">Lao People's Democratic Republic</enum>
            <enum value="LV">Latvia</enum>
            <enum value="LB">Lebanon</enum>
            <enum value="LS">Lesotho</enum>
            <enum value="LR">Liberia</enum>
            <enum value="LY">Libya</enum>
            <enum value="LI">Liechtenstein</enum>
            <enum value="LT">Lithuania</enum>
            <enum value="LU">Luxembourg</enum>
            <enum value="MO">Macao</enum>
            <enum value="MG">Madagascar</enum>
            <enum value="MW">Malawi</enum>
            <enum value="MY">Malaysia</enum>
            <enum value="MV">Maldives</enum>
            <enum value="ML">Mali</enum>
            <enum value="MT">Malta</enum>
            <enum value="MH">Marshall Islands</enum>
            <enum value="MQ">Martinique</enum>
            <enum value="MR">Mauritania</enum>
            <enum value="MU">Mauritius</enum>
            <enum value="YT">Mayotte</enum>
            <enum value="MX">Mexico</enum>
            <enum value="FM">Micronesia, Federated States of</enum>
            <enum value="MD">Moldova, Republic of</enum>
            <enum value="MC">Monaco</enum>
            <enum value="MN">Mongolia</enum>
            <enum value="ME">Montenegro</enum>
            <enum value="MS">Montserrat</enum>
            <enum value="MA">Morocco</enum>
            <enum value="MZ">Mozambique</enum>
            <enum value="MM">Myanmar</enum>
            <enum value="NA">Namibia</enum>
            <enum value="NR">Nauru</enum>
            <enum value="NP">Nepal</enum>
            <enum value="NL">Netherlands, Kingdom of the</enum>
            <enum value="NC">New Caledonia</enum>
            <enum value="NZ">New Zealand</enum>
            <enum value="NI">Nicaragua</enum>
            <enum value="NE">Niger</enum>
            <enum value="NG">Nigeria</enum>
            <enum value="NU">Niue</enum>
            <enum value="NF">Norfolk Island</enum>
            <enum value="MK">North Macedonia</enum>
            <enum value="MP">Northern Mariana Islands</enum>
            <enum value="NO">Norway</enum>
            <enum value="OM">Oman</enum>
            <enum value="PK">Pakistan</enum>
            <enum value="PW">Palau</enum>
            <enum value="PS">Palestine, State of</enum>
            <enum value="PA">Panama</enum>
            <enum value="PG">Papua New Guinea</enum>
            <enum value="PY">Paraguay</enum>
            <enum value="PE">Peru</enum>
            <enum value="PH">Philippines</enum>
            <enum value="PN">Pitcairn</enum>
            <enum value="PL">Poland</enum>
            <enum value="PT">Portugal</enum>
            <enum value="PR">Puerto Rico</enum>
            <enum value="QA">Qatar</enum>
            <enum value="RE">Réunion</enum>
            <enum value="RO">Romania</enum>
            <enum value="RU">Russian Federation</enum>
            <enum value="RW">Rwanda</enum>
            <enum value="BL">Saint Barthélemy</enum>
            <enum value="SH">Saint Helena, Ascension and Tristan da Cunha</enum>
            <enum value="KN">Saint Kitts and Nevis</enum>
            <enum value="LC">Saint Lucia</enum>
            <enum value="MF">Saint Martin (French part)</enum>
            <enum value="PM">Saint Pierre and Miquelon</enum>
            <enum value="VC">Saint Vincent and the Grenadines</enum>
            <enum value="WS">Samoa</enum>
            <enum value="SM">San Marino</enum>
            <enum value="ST">Sao Tome and Principe</enum>
            <enum value="SA">Saudi Arabia</enum>
            <enum value="SN">Senegal</enum>
            <enum value="RS">Serbia</enum>
            <enum value="SC">Seychelles</enum>
            <enum value="SL">Sierra Leone</enum>
            <enum value="SG">Singapore</enum>
            <enum value="SX">Sint Maarten (Dutch part)</enum>
            <enum value="SK">Slovakia</enum>
            <enum value="SI">Slovenia</enum>
            <enum value="SB">Solomon Islands</enum>
            <enum value="SO">Somalia</enum>
            <enum value="ZA">South Africa</enum>
            <enum value="GS">South Georgia and the South Sandwich Islands</enum>
            <enum value="SS">South Sudan</enum>
            <enum value="ES">Spain</enum>
            <enum value="LK">Sri Lanka</enum>
            <enum value="SD">Sudan</enum>
            <enum value="SR">Suriname</enum>
            <enum value="SJ">Svalbard and Jan Mayen</enum>
            <enum value="SE">Sweden</enum>
            <enum value="CH">Switzerland</enum>
            <enum value="SY">Syrian Arab Republic</enum>
            <enum value="TW">Taiwan, Province of China</enum>
            <enum value="TJ">Tajikistan</enum>
            <enum value="TZ">Tanzania, United Republic of</enum>
            <enum value="TH">Thailand</enum>
            <enum value="TL">Timor-Leste</enum>
            <enum value="TG">Togo</enum>
            <enum value="TK">Tokelau</enum>
            <enum value="TO">Tonga</enum>
            <enum value="TT">Trinidad and Tobago</enum>
            <enum value="TN">Tunisia</enum>
            <enum value="TR">Türkiye</enum>
            <enum value="TM">Turkmenistan</enum>
            <enum value="TC">Turks and Caicos Islands</enum>
            <enum value="TV">Tuvalu</enum>
            <enum value="UG">Uganda</enum>
            <enum value="UA">Ukraine</enum>
            <enum value="AE">United Arab Emirates</enum>
            <enum value="GB">United Kingdom of Great Britain and Northern Ireland</enum>
            <enum value="US">United States of America</enum>
            <enum value="UM">United States Minor Outlying Islands</enum>
            <enum value="UY">Uruguay</enum>
            <enum value="UZ">Uzbekistan</enum>
            <enum value="VU">Vanuatu</enum>
            <enum value="VE">Venezuela, Bolivarian Republic of</enum>
            <enum value="VN">Viet Nam</enum>
            <enum value="VG">Virgin Islands (British)</enum>
            <enum value="VI">Virgin Islands (U.S.)</enum>
            <enum value="WF">Wallis and Futuna</enum>
            <enum value="EH">Western Sahara</enum>
            <enum value="YE">Yemen</enum>
            <enum value="ZM">Zambia</enum>
            <enum value="ZW">Zimbabwe</enum>
        </allowed-values>
        <expect id="data-center-US" target="." test="address/country eq 'US'">
            <message>Each data center must have an address that is within the United States.</message>
        </expect>
    </constraints>

</context>
<context>
    <metapath target="/system-security-plan"/>
    <constraints>
        <expect id="resource-has-title" target="back-matter/resource" test="title" level="WARNING">
            <message>Every supporting artifact found in a citation should have a title.</message>
        </expect>
        <expect id="resource-has-base64-or-rlink" target="back-matter/resource" test="count(./rlink) >= 1 or count(./base64) >= 1" level="WARNING">
            <message>Every supporting artifact found in a citation must have at least one base64 or rlink element.</message>
        </expect>
    </constraints>
</context>
<context>
    <metapath target="/system-security-plan/metadata"/>
    <constraints>
        <expect id="data-center-count" target="." test="count(/location/prop[@name eq 'data-center']) &gt; 1">
            <message>There must be at least two (2) data centers listed.</message>
        </expect>

        <expect id="data-center-primary" target="." test="count(/location/prop[@name eq 'data-center'][@class eq 'primary']) = 1">
            <message>There must be a single primary data center.</message>
        </expect>
        <expect id="data-center-alternate" target="." test="count(/location/prop[@name eq 'data-center'][@class eq 'alternate']) &gt; 0">
            <message>There must be one or more alternate data center(s).</message>
        </expect>
    </constraints>
</context>
</metaschema-meta-constraints>
