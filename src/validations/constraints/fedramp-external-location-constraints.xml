<?xml version="1.0" encoding="UTF-8"?>
<metaschema-meta-constraints xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0">
    <!-- ================== -->
    <!-- FedRAMP Extensions -->
    <!-- ================== -->
    <context>
        <metapath target="/system-security-plan/metadata/location"/>
        <constraints>
            <expect id="data-center-count" target="." test="count(prop[@name eq 'data-center']) &gt; 1">
                <message>There must be at least two (2) data centers listed.</message>
            </expect>
            <expect id="data-center-primary" target="." test="count(prop[@name eq 'data-center'][@class eq 'primary']) = 1">
                <message>There must be a single primary data center.</message>
            </expect>
            <expect id="data-center-alternate" target="." test="count(prop[@name eq 'data-center'][@class eq 'alternate']) &gt; 0">
                <message>There must be one or more alternate data center(s).</message>
            </expect>
            <expect id="data-center-country-code" target="." test="address/country">
                <message>Each data center address must contain a country code.</message>
            </expect>
            <expect id="data-center-US" target="." test="address/country eq 'US'">
                <message>Each data center must have an address that is within the United States.</message>
            </expect>
        </constraints>
</context>
</metaschema-meta-constraints>
