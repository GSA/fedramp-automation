<?xml version="1.0" encoding="UTF-8"?>
<metaschema-meta-constraints xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0">
    <context>
        <metapath target="."/>

        <constraints>

            <allowed-values id="address-type" target="party/address/@type" allow-other="no" level="ERROR">
                <formal-name>Address Type</formal-name>
                <description>The type of address for the party</description>
                <enum value="home">Home</enum><!-- would FedRAMP ever need a "home" address? -->
                <enum value="work">Work</enum>
                <remarks><p>FedRAMP requires work addresses.</p></remarks>
            </allowed-values>

            <allowed-values id="authorization-type" target="system-characteristics/prop[@name='authorization-type'][@ns='https://fedramp.gov/ns/oscal']" allow-other="no" level="ERROR">
                <formal-name>Authorization Type</formal-name>
                <description>The FedRAMP Authorization Type</description>
                <enum value="fedramp-jab">FedRAMP JAB P-ATO</enum>
                <enum value="fedramp-agency">FedRAMP Agency ATO</enum>
                <enum value="fedramp-li-saas">FedRAMP Tailored for LI-SaaS</enum>
            </allowed-values>

            <allowed-values id="deployment-model" target="system-characteristics/prop[@name='cloud-deployment-model'][@ns='https://fedramp.gov/ns/oscal']/@value" allow-other="no" level="ERROR">
                <formal-name>Deployment Model</formal-name>
                <description>The cloud deployment model.</description>
                <enum value="public-cloud">Public Cloud</enum>
                <enum value="private-cloud">Private Cloud</enum>
                <enum value="government-only-cloud">U.S. Government Only</enum>
                <enum value="hybrid-cloud">Hybrid</enum>
                <enum value="other">Other</enum>
            </allowed-values>

            <context>
                <metapath target="security-sensitivity-level"/>
                <metapath target="security-impact-level"/>
                <metapath target="(security-objective-confidentiality|security-objective-integrity|security-objective-availability)"/>
                <metapath target="system-information/information-type/(confidentiality-impact|integrity-impact|availability-impact)/(base|selected)"/>
                <allowed-values id="security-level" target="." allow-other="no" level="ERROR">
                    <formal-name>Security Impact Level</formal-name>
                    <description>The security objective level as defined by NIST SP 800-60.</description>
                    <enum value="fips-199-low">Low</enum>
                    <enum value="fips-199-moderate">Moderate</enum>
                    <enum value="fips-199-high">High</enum>
                </allowed-values>
            </context>

         </constraints>

    </context>

</metaschema-meta-constraints>
